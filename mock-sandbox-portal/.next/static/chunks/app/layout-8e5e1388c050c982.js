(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{7019:function(t,e,a){Promise.resolve().then(a.t.bind(a,3649,23)),Promise.resolve().then(a.t.bind(a,3385,23)),Promise.resolve().then(a.bind(a,3779))},3779:function(t,e,a){"use strict";a.r(e),a.d(e,{AuthProvider:function(){return c},useAuth:function(){return u}});var n=a(7437),r=a(2265),o=a(1490),i=a(8222);let s=(0,r.createContext)(void 0);function c(t){let{children:e}=t,[a,c]=(0,r.useState)(null),[u,l]=(0,r.useState)(!0);(0,r.useEffect)(()=>{o.Z.get("auth_token")?p():l(!1)},[]);let p=async()=>{try{let t=await i.as.getProfile();c(t.merchant),l(!1)}catch(t){o.Z.remove("auth_token"),c(null),l(!1)}},h=async(t,e)=>{try{let a=await i.kv.login(t,e);if(a.success&&a.token)o.Z.set("auth_token",a.token,{expires:7}),c(a.merchant);else throw Error(a.error||"Login failed")}catch(t){throw console.error("Login error in AuthContext:",t),t}},d=async()=>{await i.kv.logout(),c(null)},f=async t=>await i.kv.register(t);return(0,n.jsx)(s.Provider,{value:{user:a,isAuthenticated:!!a,isLoading:u,login:h,logout:d,register:f},children:e})}function u(){let t=(0,r.useContext)(s);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t}},8222:function(t,e,a){"use strict";a.d(e,{L2:function(){return c},as:function(){return s},kv:function(){return i},vD:function(){return u}});var n=a(4829),r=a(1490);let o=n.Z.create({baseURL:"https://sandbox.mycodigital.io",headers:{"Content-Type":"application/json"}});o.interceptors.request.use(t=>{let e=r.Z.get("auth_token");return e&&(t.headers.Authorization="Bearer ".concat(e)),t}),o.interceptors.response.use(t=>t,t=>{var e;return(null===(e=t.response)||void 0===e?void 0:e.status)===401&&(r.Z.remove("auth_token"),window.location.href="/login"),Promise.reject(t)});let i={login:async(t,e)=>(await o.post("/api/portal/auth/login",{email:t,password:e})).data,register:async t=>(await o.post("/api/portal/auth/register",t)).data,logout:async()=>{await o.post("/api/portal/auth/logout"),r.Z.remove("auth_token")}},s={getProfile:async()=>(await o.get("/api/portal/merchant/profile")).data,updateProfile:async t=>(await o.put("/api/portal/merchant/profile",t)).data,getCredentials:async()=>(await o.get("/api/portal/merchant/credentials")).data,generateApiKey:async()=>(await o.post("/api/portal/merchant/credentials")).data},c={list:async t=>(await o.get("/api/portal/transactions",{params:t})).data,get:async t=>(await o.get("/api/portal/transactions/".concat(t))).data,export:async(t,e)=>(await o.get("/api/portal/transactions/export/".concat(t),{params:e,responseType:"blob"})).data},u={getStats:async()=>(await o.get("/api/portal/dashboard/stats")).data}},3385:function(){},3649:function(t){t.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(t){t.O(0,[694,971,458,744],function(){return t(t.s=7019)}),_N_E=t.O()}]);